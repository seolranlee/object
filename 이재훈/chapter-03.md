### # Chapter 03 역할, 책임, 협력

- `클래스, 상속, 지연 바인딩 등`의 개념들도 중요하지만, `구현에 치우친 내용`이라서 패러다임의 본질과는 거리가 다소 있다.
- 본질은 `협력하려는 객체들의 공동체`를 만드는 것. `역할, 책임, 협력`에 집중하자
  - 여기에 집중하지 못한다면, 응집도 높은 클래스와 중복없는 상속 계층을 잘 그려내도 나중에는 문제가 발생할 수 있다.

#### # 01 협력

- 객체지향을 따르는 애플리케이션

  - 하나의 객체에 의해 제어흐름이 통제되지 않고, `다양한 객체들 사이에 균형있게 분배되는 것이 일반적`이다.
  - `메시지`를 주고받으면서 상호작용 하는데, 이를 `협력`이라고 함

- `협력`

  - 객체는 다른 객체의 내부 구현이 접근할 수 없기 때문에, `오직 메시지 전송만을 통해서만` 요청을 전달할 수 있다.
  - 이 요청을 `수신한 객체는 메서드를 통해 요청에 응답`한다.
    - \*\* 중요한 점은, 이때 메시지를 처리할 방법은 `스스로 선택`한다는 것
    - 각 객체가 `자율적`이라고 생각해야 한다.
      - => `캡슐화`

- `문맥을 위한` 협력
  - 객체는 반드시 어떤 협력에 참여하고 있다
    - `어떤 행동`을 할 것인지 결정하는 것은 객체가 참여하고 있는 `협력`
  - 예제에서의 Movie
    - 일반적으로 단순히 영화라는 단어를 들었을 때 역할
      - 영화를 상영 -> Movie는 play를 수행할 것이라 생각
    - 예제에서의 영화의 역할
      - 영화 예매를 위한 협력 -> '요금 계산'의 `책임`을 갖고 있음 -> calculate를 수행
  - \*\* `문맥을 고려하지 않고` `객체의 행동을 결정`하는 것은 아무런 의미가 없다.
  - \*\* `문맥` -> `행동`을 결정 -> `상태`를 결정
    - \*\* 클래스에서 어떤 관계는 `인스턴스 변수`로, 어떤 관계는 `메시지 송수신`으로 의존성이 생기는지 궁금했는데, 결국 문맥을 잘 파악하고 협력 관계를 잘 설정해라는 말인 것 같다.

#### # 02 책임

- `책임`

  - `협력에 참여하기 위해` 수행하는 `행동`

- `크레이그 라만`의 책임 분류

  - `하는 것`, `아는 것`으로 나눈다.
  - 여기서 설명해주는 책임에 대해서 크게 특별하게 다른 점은 못 느꼈다.
    - 앞서 말한 협력, 문맥 이야기와 거의 비슷하다고 느낌.
    - 결국에 어떤 `문맥` 안에서 `각 객체들이 어떤 책임을 지게할지` 잘 정의하는게 제일 중요하다고 함
      - 그냥 잘 생각해보라는 것으로밖에 들리지 않았다.

- `CRC 카드`

  - C(`후보`) R(`책임`) C(`협력자`)
  - `다이어그램` vs `CRC` 카드
    - \*\* 다이어그램은 `추상적이고 가상적`인데 CRC 카드는 `구체적 실재적`이다.
    - 개인적으로도 CRC 카드가 글자로 되어있어서 그런지 관계를 그리는 데 개인적으로 더 도움이 되는 느낌

- `책임 할당`

  - 자율적인 객체를 만드는 가장 기본적인 방법
    - 특정 책임에 대해 가장 잘 알고 있는 `전문가`에게 맡기기
  - \*\* 문맥을 파악해 책임을 할당하고, 개발하면서 `점점 더 많은 책임을 찾아내고, 그 책임들을 다시 객체들에게 할당하는 과정을 반복`해야한다.
  - `메시지`가 `퍼블릭 인터페이스`를 구성한다는 것을 주목

- 책임과 관련된 2가지 규칙
  - `메시지`가 `객체를 결정`한다
    - 객체가 메시지를 선택하는 것이 아니라, `메시지를 먼저 선별`하고 해당 메시지를 처리할 객체를 선별해야 함
    - \*\* 이유
      - `최소한`의 인터페이스를 가지게 됨
      - `추상적`인 인터페이스를 가지게 됨
  - `행동`이 `상태를 결정`한다
    - \*\* `가장 많이 하는 실수`는 객체를 먼저 정하고, 거기에 더해서 `상태를 먼저 정의하는 것`
    - 문맥과 협력을 먼저 정해야하 하는 것과 같이 `행동을 먼저 정해야 한다.`
    - \*\* `상태`는 `행동을 정상적으로 수행`하기 위한 `보조적인 도구일 뿐`

#### # 03 역할

- `역할`

  - `책임`의 집합
  - \*\* 협력을 모델링할때는 `객체`가 아니라 `역할에 책임을 할당한다고 생각하는 것이 좋음`

- `유연하고 재사용 가능`한 `협력`

  - 협력은 `슬롯 같은 개념`
    - ex. 할인 정책이라는 개념이 많을 수가 있는데, `일일이 모든 객체에` 그 책임을 지정해주면 많은 `중복이 발생`한다.
  - 결국 `슬롯`과 같다는 말은 `추상화`라는 말과 동일

- 역할의 구현

  - `인터페이스`
    - `100% 책임의 집합만`을 나열
  - `추상 클래스`
    - `일부는 구현`해둔 것

- 객체 대 역할

  - \*\* `한 종류의 객체만 참여하는 경우`, `역할을 할당하는 것`은 오히려 `비효율적`인 것은 아닐까?
    - 만약 그 시점에 참여하는 `객체가 하나라면 객체로 간주해도 된다.` 추후에 `여러 종류의 객체가 생기는 시점`에 `역할의 개념으로 생각`하면 됨

- 각 부분들의 관계

  - 협력 -> 역할 -> 객체 -> 클래스

- 역할의 `불확실성`

  - \*\* 당연한 것
    - 사람들이 세상을 바라볼 때, `무의식적으로 모든 개념을 뒤섞어서 생각`
    - 특히나 `설계 초반`에는 명확하게 드러나지 않을 것
  - 제일 중요한 것
    - 각 객체의 `협력관계를 잘 생각`하고, `책임을 잘 할당`하는 것이 제일 중요
    - 객체, 역할을 정의하는 것은 그냥 개발하면서 정리해도 됨
      - 초반에 `불확실하다면 그냥 객체로 생각`해라

- 역할과 `추상화`

  - 둘은 거의 동일한 개념
  - \*\* 따라서 추상화의 장점 = 역할의 장점
    - `세부적인 사항을 무시`하고 `상위 개념으로 정리가 가능`
    - `설계를 유연`하게 한다

- 배우와 배역에 비유
  - `한 배역`은 `여러 배우`가 연기할 수 있다.
  - \*\* 마찬가지로, `한 배우도` 각 상황에 따라 `여러 배역을 가질 수 있다.`
